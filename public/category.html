<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Category Management</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
  integrity="sha512-pbQgB94TP8t0uhrWD61FmuqtnuhEv1FvOfEXfOYzgkUoD7GgQul1XJ+OaKXUJ3+e/9d4MFUMzF3cuupJUXTtXg==" 
  crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous" />
  <!-- DataTables Buttons Bootstrap 4 CSS -->
  <link rel="stylesheet"
    href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.bootstrap4.min.css"
    integrity="sha512-vWTrt2A9iAn2pK8hNZS26YZRDDUvLiOfyL+MmBEXJizrigtxnpLuLrLOOMm+pcrUJFzGssUwoS6Gofp+TT2deQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- SweetAlert2 CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.css"
    integrity="sha512-fjO3Vy3QodX9c6G9AUmr6WuIaEPdGRxBjD7gjatG5gGylzYyrEq3U0q+smkG6CwIY0L8XALRFHh4KPHig0Q1ug=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
:root {
  --primary-orange: #FF7B25;
  --primary-yellow: #FFC837;
  --dark-orange: #E64A19;
  --light-yellow: #FFF9C4;
  --accent-blue: #1976D2;
  --dark-gray: #2C3E50;
  --light-gray: #F5F7FA;
}

body {
  font-family: 'Roboto', sans-serif;
  background-color: #f8f9fa;
  color: #333;
  line-height: 1.6;
}

h1, h2, h3, h4, h5, h6 {
  font-family: 'Oswald', sans-serif;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.card {
  border: none;
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
}

.card-header {
  background: linear-gradient(135deg, var(--primary-orange), var(--primary-yellow));
  color: white;
  padding: 1.25rem 1.5rem;
  border-bottom: none;
}

.card-header h3 {
  margin: 0;
  font-weight: 600;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
}

.table-responsive {
  border-radius: 10px;
  overflow: hidden;
  padding-top: 15px;
}

#ctable {
  border-collapse: separate;
  border-spacing: 0;
}

#ctable thead th {
  background-color: var(--dark-gray);
  color: white;
  font-family: 'Oswald', sans-serif;
  font-weight: 500;
  letter-spacing: 0.5px;
  border: none;
  padding: 12px 15px;
}

#ctable tbody tr {
  transition: all 0.2s ease;
}

#ctable tbody tr:hover {
  background-color: rgba(255, 200, 55, 0.1);
  transform: scale(1.005);
}

#ctable tbody td {
  padding: 12px 15px;
  vertical-align: middle;
  border-bottom: 1px solid #eee;
}

.badge {
  font-weight: 500;
  padding: 6px 10px;
  border-radius: 12px;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.badge-secondary {
  background-color: #95a5a6;
}

.badge-primary {
  background-color: var(--accent-blue);
}

.badge-success {
  background-color: #27ae60;
}

.badge-danger {
  background-color: #e74c3c;
}

.badge-warning {
  background-color: #f39c12;
  color: white;
}

.btn {
  font-family: 'Oswald', sans-serif;
  font-weight: 500;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary-orange), var(--primary-yellow));
}

.btn-primary:hover {
  background: linear-gradient(135deg, var(--dark-orange), var(--primary-yellow));
}

.btn-warning {
  background: linear-gradient(135deg, #F39C12, #F1C40F);
  color: white;
}

.btn-danger {
  background: linear-gradient(135deg, #E74C3C, #C0392B);
  color: white;
}

.btn-outline-danger {
  border: 2px solid #E74C3C;
  color: #E74C3C;
  background: transparent;
}

.btn-outline-success {
  border: 2px solid #27ae60;
  color: #27ae60;
  background: transparent;
}

.btn-outline-secondary {
  border: 2px solid #95a5a6;
  color: #95a5a6;
  background: transparent;
}

.input-group {
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
  border-radius: 6px;
  overflow: hidden;
}

.form-control {
  border: none;
  padding: 12px 15px;
  font-family: 'Roboto', sans-serif;
}

.form-control:focus {
  box-shadow: 0 0 0 0.2rem rgba(255, 123, 37, 0.25);
}

.input-group-append .btn {
  border-radius: 0 6px 6px 0;
}

.modal-content {
  border: none;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
}

.modal-header {
  background: linear-gradient(135deg, var(--primary-orange), var(--primary-yellow));
  color: white;
  border-bottom: none;
}

.modal-title {
  font-family: 'Oswald', sans-serif;
  letter-spacing: 0.5px;
}

.close {
  color: white;
  text-shadow: none;
  opacity: 0.8;
}

.close:hover {
  opacity: 1;
}

.dt-buttons {
  display: inline-block;
  margin-bottom: 0;
}

.dt-buttons .btn {
  margin-right: 5px;
  margin-bottom: 0;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

.slide-up {
  animation: slideUp 0.4s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { 
    opacity: 0;
    transform: translateY(20px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.pulse {
  animation: pulse 0.5s ease;
}

.status-shipped {
  color: var(--accent-blue);
}

.status-delivered {
  color: #27ae60;
}

.status-cancelled {
  color: #e74c3c;
}

.status-pending {
  color: #f39c12;
}

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
}

::-webkit-scrollbar-thumb {
  background: var(--primary-orange);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--dark-orange);
}

/* New layout styles */
.action-buttons-container {
  position: relative;
  display: flex;
  align-items: center;
  margin-bottom: 20px;
  width: 100%;
}

.action-buttons-container > .d-flex {
  width: 100%;
  position: relative;
}

.left-buttons-group {
  display: flex;
  align-items: center;
}

.search-container {
  width: 300px;
  margin-left: auto; /* This pushes search to the right */
}

.view-mode-toggle {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 8px;
}

.view-mode-toggle .btn {
  margin: 0;
}

/* Responsive adjustments */
@media (max-width: 992px) {
  .action-buttons-container > .d-flex {
    flex-direction: column;
    gap: 15px;
  }
  
  .left-buttons-group {
    width: 100%;
    justify-content: flex-start;
  }
  
  .search-container {
    width: 100%;
    margin-left: 0;
    order: 3;
  }
  
  .view-mode-toggle {
    position: static;
    left: auto;
    transform: none;
    justify-content: center;
    width: 100%;
    order: 2;
    margin: 10px 0;
  }
}

/* Additional button styling for the new layout */
#pdfExportBtn {
  margin-right: 12px;
}

/* Ensure DataTables buttons don't interfere */
.dt-buttons {
  display: none; /* Hide since we're using our own PDF button */
}

.action-icons {
  display: flex;
  gap: 12px;
}

.action-icons a {
  color: inherit;
  transition: all 0.2s ease;
}

.action-icons a:hover {
  transform: scale(1.2);
}

.action-icons .fa-edit {
  color: var(--accent-blue);
}

.action-icons .fa-trash-alt {
  color: #e74c3c;
}

.action-icons .fa-undo {
  color: #27ae60;
}
  </style>

  <!-- jQuery (must come first) -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"
    integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
  <!-- Popper.js (for Bootstrap) -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <!-- DataTables -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
    integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.bootstrap4.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.3.5/js/buttons.html5.min.js"></script>
  <!-- PDFMake for export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
  <!-- SweetAlert2 JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.min.js"
    integrity="sha512-LGHBR+kJ5jZSIzhhdfytPoEHzgaYuTRifq9g5l6ja6/k9NAOsAi5dQh4zQF6JIRB8cAYxTRedERUF+97/KuivQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div id="header"></div>

  <div class="container-fluid py-4">
    <div class="card slide-up">
      <div class="card-header">
        <h3 class="mb-0"><i class="fas fa-tags mr-2"></i>Category Management</h3>
      </div>
      <div class="card-body">
        <div class="action-buttons-container mb-4">
          <div class="d-flex justify-content-between align-items-center w-100">
              <!-- Left-aligned buttons -->
              <div class="left-buttons-group">
                  <!-- PDF Button -->
                  <button class="btn btn-outline-danger mr-3" id="pdfExportBtn">
                      <i class="fas fa-file-pdf"></i> PDF
                  </button>
                  <!-- Add Category Button -->
                  <button class="btn btn-success" id="addCategoryBtn">
                      <i class="fas fa-plus"></i> Add Category
                  </button>
              </div>
              
              <!-- Center-aligned view mode toggles -->
              <div class="view-mode-toggle">
                  <button class="btn btn-secondary pagination-mode active" data-mode="pagination">
                      <i class="fas fa-list-ol"></i> Pagination
                  </button>
                  <button class="btn btn-secondary infinite-scroll-mode" data-mode="infinite">
                      <i class="fas fa-infinity"></i> Infinite Scroll
                  </button>
              </div>
              
              <!-- Right-aligned search -->
              <div class="search-container">
                  <div class="input-group">
                      <input type="text" id="categorySearch" class="form-control" placeholder="Search categories...">
                      <div class="input-group-append">
                          <button class="btn btn-primary" type="button" id="searchButton">
                              <i class="fas fa-search"></i> Search
                          </button>
                      </div>
                  </div>
              </div>
          </div>
        </div>
        <div class="table-responsive fade-in">
          <table id="ctable" class="table table-hover" style="width:100%">
            <thead>
              <tr>
                <th>ID</th>
                <th>Description</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Categories will load here dynamically -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Category Modal -->
  <div class="modal fade" id="categoryModal" tabindex="-1" role="dialog" aria-labelledby="categoryModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="categoryModalLabel"><i class="fas fa-tag mr-2"></i>Category Form</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form id="cform">
          <div class="modal-body">
            <div class="form-group">
              <label for="category_description" class="font-weight-bold">Description</label>
              <input type="text" class="form-control" id="category_description" name="description" required>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="categorySubmit">Save</button>
            <button type="button" class="btn btn-success" id="categoryUpdate" style="display: none;">Update</button>
          </div>
        </form>
      </div>
    </div>
  </div>

<script>
$(document).ready(function () {
  const url = 'http://localhost:3000/';

  // Load header
  $('#header').load('/header_admin.html', function() {
    // Admin check
    $.ajax({
      url: 'http://localhost:3000/api/auth/admin-check',
      method: 'GET',
      headers: {
        'Authorization': 'Bearer ' + (localStorage.getItem('token') || ''),
        'X-Tab-Context': 'admin'
      },
      success: function(res) {
        console.log(' Admin verified:', res.user);
        
        // TAB CONTEXT VERIFICATION
        if (sessionStorage.getItem('tabRole') !== 'admin') {
          alert(' Security Alert: Please access categories through admin interface');
          logoutAdmin();
          return;
        }
      },
      error: function(xhr) {
        const defaultMsg = "Only admins can access this page.";
        const message = xhr.responseJSON?.message || defaultMsg;
        
        if (xhr.status === 403 && message.includes('interface')) {
          alert(' Admin account detected - redirecting to admin portal');
          window.location.href = '/home_admin.html';
        } else if (xhr.status === 401) {
          alert(' Session expired - please login again');
          logoutAdmin();
        } else {
          alert(message);
          logoutAdmin();
        }
      }
    });
  });

  function logoutAdmin() {
    localStorage.removeItem('token');
    localStorage.removeItem('userId');
    localStorage.removeItem('role');
    sessionStorage.removeItem('tabRole');
    window.location.href = '/login.html';
  }

  // Initialize Categories DataTable
  const table = $('#ctable').DataTable({
    ajax: {
      url: `${url}api/category/admin/all`,
      dataSrc: "data",
    },
    dom: 'rtip',
    buttons: [
      {
        extend: 'pdf',
        text: '<i class="fas fa-file-pdf"></i> PDF',
        className: 'btn btn-outline-danger mr-2'
      }
    ],
    columns: [
      { data: 'category_id' },
      { data: 'description' },
      {
        data: null,
        render: function (data) {
          let btns = `
            <div class="action-icons">
              <a href='#' class='editCategoryBtn' data-id="${data.category_id}" title="Edit">
                <i class='fas fa-edit'></i>
              </a>
              <a href='#' class='deleteCategoryBtn' data-id="${data.category_id}" title="Delete">
                <i class='fas fa-trash-alt'></i>
              </a>`;
          if (data.deleted_at) {
            btns += `
              <a href='#' class='unarchiveCategoryBtn' data-id="${data.category_id}" title="Restore">
                <i class='fas fa-undo'></i>
              </a>`;
          }
          return btns + '</div>';
        }
      }
    ]
  });

  // PDF export button
  $('#pdfExportBtn').click(function() {
    table.button('.buttons-pdf').trigger();
  });

  // Add Category button handler
  $('#addCategoryBtn').click(function() {
    resetAndShowModal();
  });

  // View mode toggle functionality
  $('.pagination-mode').click(function() {
    $('.view-mode-toggle .btn').removeClass('active');
    $(this).addClass('active');
    // Implement pagination mode logic here
    table.page.len(10).draw(); // Set to show 10 items per page
    $('#ctable').parent().css('overflow-y', 'hidden');
    console.log('Pagination mode activated');
  });

  $('.infinite-scroll-mode').click(function() {
    $('.view-mode-toggle .btn').removeClass('active');
    $(this).addClass('active');
    // Implement infinite scroll mode logic here
    table.page.len(-1).draw(); // Show all items
    $('#ctable').parent().css('overflow-y', 'auto').css('max-height', '500px');
    console.log('Infinite scroll mode activated');
  });

  // Initialize with pagination mode
  $('.pagination-mode').click();

  // Search functionality
  $('#searchButton').on('click', function() {
    table.search($('#categorySearch').val()).draw();
    $(this).addClass('animate__animated animate__pulse');
    setTimeout(() => $(this).removeClass('animate__animated animate__pulse'), 1000);
  });

  $('#categorySearch').on('keyup', function(e) {
    if (e.keyCode === 13) {
      table.search($(this).val()).draw();
      $('#searchButton').addClass('animate__animated animate__pulse');
      setTimeout(() => $('#searchButton').removeClass('animate__animated animate__pulse'), 1000);
    }
  });

  // Modal handling functions
  function resetAndShowModal() {
    $("#cform").trigger("reset");
    $('#categoryModal').modal({ backdrop: 'static', keyboard: false }).modal('show');
    $('#categoryUpdate').hide();
    $('#categorySubmit').show();
    $('#categoryId').remove();
    $('#category_description').val('').focus();
  }

  function closeModal() {
    $('#categoryModal').modal('hide');
  }

  // Modal close handlers
  $(document).on('click', '[data-dismiss="modal"], .modal-footer .btn-secondary', function() {
    closeModal();
  });

  // Submit new category
  $("#categorySubmit").on('click', function (e) {
    e.preventDefault();
    const formData = { description: $('#category_description').val() };

    if (!formData.description.trim()) {
      Swal.fire({
        icon: 'error',
        title: 'Error',
        text: 'Please enter a category description'
      });
      return;
    }

    $.ajax({
      method: "POST",
      url: `${url}api/category`,
      data: JSON.stringify(formData),
      contentType: "application/json",
      success: function () {
        closeModal();
        Swal.fire({
          icon: 'success',
          title: 'Success',
          text: 'Category created successfully'
        });
        table.ajax.reload(null, false);
      },
      error: function (err) {
        console.log(err);
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: err.responseJSON?.error || "Error creating category"
        });
      }
    });
  });

  // Edit category button
  $('#ctable tbody').on('click', 'a.editCategoryBtn', function (e) {
    e.preventDefault();
    resetAndShowModal();
    
    const id = $(this).data('id');
    $('<input>').attr({ type: 'hidden', id: 'categoryId', name: 'category_id', value: id }).appendTo('#cform');
    $('#categorySubmit').hide();
    $('#categoryUpdate').show();

    $.ajax({
      method: "GET",
      url: `${url}api/category/${id}`,
      dataType: "json",
      success: function (data) {
        const { result } = data;
        $('#category_description').val(result[0].description).focus();
      },
      error: function () {
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: 'Failed to load category data'
        });
        closeModal();
      }
    });
  });

  // Update category
  $("#categoryUpdate").on('click', function (e) {
    e.preventDefault();
    const id = $('#categoryId').val();
    const formData = { description: $('#category_description').val() };

    if (!formData.description.trim()) {
      Swal.fire({
        icon: 'error',
        title: 'Error',
        text: 'Please enter a category description'
      });
      return;
    }

    $.ajax({
      method: "PUT",
      url: `${url}api/category/${id}`,
      data: JSON.stringify(formData),
      contentType: "application/json",
      success: function () {
        closeModal();
        Swal.fire({
          icon: 'success',
          title: 'Success',
          text: 'Category updated successfully'
        });
        table.ajax.reload(null, false);
      },
      error: function (xhr) {
        const errorMessage = xhr.responseJSON?.error || "Error updating category";
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: errorMessage
        });
      }
    });
  });

  // Delete category
  $('#ctable tbody').on('click', 'a.deleteCategoryBtn', function (e) {
    e.preventDefault();
    const id = $(this).data('id');

    Swal.fire({
      title: 'Are you sure?',
      text: "This category will be archived. You can restore it later.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, archive it!'
    }).then((result) => {
      if (result.isConfirmed) {
        $.ajax({
          method: "DELETE",
          url: `${url}api/category/${id}`,
          success: function (data) {
            table.ajax.reload(null, false);
            Swal.fire(
              'Archived!',
              'The category has been archived.',
              'success'
            );
          },
          error: function (xhr) {
            const errorMessage = xhr.responseJSON?.error || "Error archiving category";
            Swal.fire({
              icon: 'error',
              title: 'Error',
              text: errorMessage
            });
          }
        });
      }
    });
  });

  // Restore category
  $('#ctable tbody').on('click', 'a.unarchiveCategoryBtn', function (e) {
    e.preventDefault();
    const id = $(this).data('id');

    Swal.fire({
      title: 'Are you sure?',
      text: "This category will be restored.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, restore it!'
    }).then((result) => {
      if (result.isConfirmed) {
        $.ajax({
          method: "PUT",
          url: `${url}api/category/restore/${id}`,
          success: function () {
            table.ajax.reload(null, false);
            Swal.fire(
              'Restored!',
              'The category has been restored.',
              'success'
            );
          },
          error: function (xhr) {
            const errorMessage = xhr.responseJSON?.error || "Error restoring category";
            Swal.fire({
              icon: 'error',
              title: 'Error',
              text: errorMessage
            });
          }
        });
      }
    });
  });

  window.addEventListener('storage', function(event) {
    // Handle logout from other tabs
    if (event.key === 'token' && event.newValue === null) {
      alert(' Session ended in another tab');
      logoutAdmin();
    }
    
    // Handle role changes
    if (event.key === 'role' && event.newValue !== 'admin') {
      alert(' Account type changed - redirecting...');
      logoutAdmin();
    }
  });
});
</script>

<div id="footer"></div>

<script>
    // Load footer
    $(document).ready(function() {
        $('#footer').load('/footer_admin.html');
    });
</script>

</body>
</html>